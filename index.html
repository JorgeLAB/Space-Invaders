<!DOCTYPE html>
<html lang='br'>
<head>   <!-ctrl + alt + C open browser--> 
	<meta charset = "UTF-8">
	<title>Space Invaders</title>
	<script src="js/helpers.js">

	</script>
	<style>
	   /* background of the game */
     	
       canvas{
           background-color: #000; 
           display: block;
           position: absolute;
           margin: auto;
           top: 0;
           bottom: 0;
           left:  0;
           right: 0;	
       }    
      
	</style>
		 
</head>
<body>
  



</body>
<script>
/* Variables enable in the game */ 
  var screen, input, frames, spFrame, lvFrame;     // display 
  var alSprite, taSprite, ciSprite; // Sprites three category
  var aliens, dir, tank, bullets, cities; // dir is and bullets is projectiles
  
  function main() {
    screen = new Screen(504, 600);  
    input = new InputHandeler();

    var img = new Image();  // this API Image() constructor is equivalent to document.createElement('img'). Variable local.

    img.addEventListener("load", function(){ // this function split the image getting the sprites
            alSprite = [
		    	[new Sprite(this, 0 , 0, 22, 16) , new Sprite(this,0 , 16, 22,16)],	// each square is 8 px             	
				  [new Sprite(this, 22, 0, 16, 16), new Sprite(this,22, 16, 16, 16)], 
				  [new Sprite(this, 38, 0, 24, 16), new Sprite(this, 38, 16, 24, 16)] 
       	];
       	taSprite = new Sprite(this, 62, 0 , 22, 16);
        ciSprite = new Sprite(this, 84, 8, 36, 24);
        
        init();
        run();

        });

        img.src = "image/invaders.png"; 
    };
  
  function init(){ // queuing the aliens 
      frame = 0; // inicialization
      spFrame = 0;
      lvFrame = 20; 
      dir = 1;


      aliens = [];
      var rows = [1, 0, 0, 2, 2]; // defination tipy of alien
      for(var i = 0, len = rows.length; i<len; i++){
          for(var j=0; j<10; j++){
              var a = rows[i];
              aliens.push({ 
                sprite: alSprite[a],
                x:30 + j*30 + [0,5,0][a], // I don't understand [0,5,0]
                y:30 + i*30, // vertical space
                w:alSprite[a][0].w,  // I don't understand this pass don't change anything.
                h:alSprite[a][0].h   // basec if you del line 72 and 73 the program run normaly.
              });
        }
      }
  };

  function run(){
   	var loop = function() {
   		update();
   		render();
   		window.requestAnimationFrame(loop, screen.canvas);
   	
    };
   	window.requestAnimationFrame(loop, screen.canvas);
   };
  function update(){
      frame++;
      if(frame% lvFrame === 0){
        spFrame = (spFrame + 1) % 2; // I don't understand this pass
        
        var _max = 0, _min = screen.width ; // max position in the screen and min position;
         

        for(var i= 0 , len = aliens.length; i<len; i++){
          var a = aliens[i];
          a.x += 30*dir;
          _max = Math.max(_max, a.x + a.w ); // I can't interpret this pass.
          _min = Math.min(_min,a.x);
        }
        if(_max > screen.width - 30 || _min < 30){ // When the aliens reach the right wall (less 30px) back and or when it comes to the beginning back 
          dir*= - 1  ;
          for( var i = 0, len = aliens.length; i<len; i++){
               aliens[i].x += 30*dir; //jumps controls for other lines space 
               aliens[i].y += 20; // vertical jumps
          }
        }

      }
  };
              
  function render(){ // aliens is global variable
      screen.clear();  

   	  for( var i=0, len = aliens.length; i<len; i++){
        var a = aliens[i];
        screen.drawSprite(a.sprite[spFrame],a.x,a.y); // a.sprite[0] is position of recharge and a.sprite[1] is position of attack
       }
  };

  main();

</script> 

</html>